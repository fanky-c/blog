---
title: node中使用redis做请求限流
date: 2021-08-14 16:04:04
tags:
   - node限流
   - redis
---

## 限流介绍
请求限流用于控制网络请求和传输量的技术， 用于健全node服务应用， **通常会开启接口速率限制，来控制一定周期内最大的请求量，用于保护服务应用免遭恶意请求和流量攻击**

## 限流常用算法 
### 1. 固定窗口算法
#### a. 介绍
 固定窗口算法： 在固定的时间范围内，窗口大小指允许通过最大请数。 也就是一段时间内最大允许请求量

#### b. 代码实现
  
  

### 2. 滑动窗口算法
#### a. 介绍
滑动窗口算法：这种算法是对固定窗口算法一种优化（这种算法一定范围内只有一个窗口）， 在一个周期范围内有多个窗口进行计数， 窗口越多， 算法就越平滑。

#### b. 代码实现



### 3. 漏桶算法
#### a. 介绍
漏桶算法：api请求过程类比漏桶加水，漏桶流入速度不做限制， 而是限制漏桶流出速度； 当流入速度大于流出速度， 随着桶中水平面不断上涨， 漏桶水流就会溢出，


#### b. 代码实现


### 4. 令牌桶算法
#### a. 介绍
令牌桶算法：定义了一个集合（也就是桶）， 集合中容纳一定数量的令牌， api被请求一次消耗一个令牌； 如集合中没有令牌则不允许请求通过， 集合通过一定的速率去生成新的令牌， 以此达到限流的作用。


#### b. 代码实现

## redis-cell模块

## nginx 限制IP的连接和并发达到限流 


[参考文章1](https://vv13.cn/Algorithm/20200902_%E6%89%8B%E6%8A%8A%E6%89%8B%E6%95%99%E4%BD%A0%E5%9C%A8Node.js%E4%B8%AD%E4%BD%BF%E7%94%A8Redis%E5%81%9A%E8%AF%B7%E6%B1%82%E9%99%90%E6%B5%81/)

[参考文章2](http://www.html.cn/qa/node-js/10803.html)